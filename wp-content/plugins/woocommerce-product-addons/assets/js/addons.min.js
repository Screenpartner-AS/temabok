jQuery(function(v){var b={isGroupedMixedProductType:function(){var a=v(".product-type-grouped"),o=0,t=0;return!!(a.length&&(a.find(".group_table tr.product").each(function(){0<v(this).find(".input-text.qty").val()&&(v(this).find(".entry-summary .subscription-details").length?o++:t++)}),0<o&&0<t))},escapeHtml:function(a){return document.createElement("div").appendChild(document.createTextNode(a)).parentNode.innerHTML},isGroupedSubsSelected:function(){var a=v(".product-type-grouped"),o=!1;return a.length&&a.find(".group_table tr.product").each(function(){if(0<v(this).find(".input-text.qty").val()&&v(this).find(".entry-summary .subscription-details").length)return!(o=!0)}),o},formatMoney:function(a){return accounting.formatMoney(a,{symbol:woocommerce_addons_params.currency_format_symbol,decimal:woocommerce_addons_params.currency_format_decimal_sep,thousand:woocommerce_addons_params.currency_format_thousand_sep,precision:woocommerce_addons_params.trim_trailing_zeros?0:woocommerce_addons_params.currency_format_num_decimals,format:woocommerce_addons_params.currency_format})},getCostByTax:function(a,o){a=(!woocommerce_addons_params.price_include_tax||!woocommerce_addons_params.display_include_tax)&&(woocommerce_addons_params.price_include_tax&&!woocommerce_addons_params.display_include_tax||!woocommerce_addons_params.price_include_tax&&woocommerce_addons_params.display_include_tax||woocommerce_addons_params.price_include_tax||woocommerce_addons_params.display_include_tax)?o:a;return a},init:function(a){var f=document.querySelector("form.cart"),w="1"===document.querySelector("[data-show-incomplete-sub-total]").dataset.showIncompleteSubTotal,g=!1,h=a,y=!!h.hasClass("variations_form")&&h.find('input[name="variation_id"], input.variation_id');v(".variations_form").on("woocommerce_variation_select_change",function(){h.trigger("woocommerce-product-addons-update")}),h.on("click",".reset_variations",function(){g=!1,v.each(h.find(".product-addon"),function(){var a=v(this).find(".addon");(a.is(":checkbox")||a.is(":radio"))&&a.prop("checked",!1),a.is("select")&&a.prop("selectedIndex",0),(a.is(":text")||a.is("textarea")||a.is('input[type="number"]')||a.is('input[type="file"]'))&&a.val("")}),h.trigger("woocommerce-product-addons-update")}).on("keyup change",".wc-pao-addon input, .wc-pao-addon textarea",function(){var a;0<v(this).attr("maxlength")&&(a=v(this).val(),a=v(this).attr("maxlength")-a.length,v(this).next(".wc-pao-addon-chars-remaining").find("span").text(a))}).on("change",".wc-pao-addon input, .wc-pao-addon textarea, .wc-pao-addon select, input.qty, .wc-pao-addon-custom-text",function(){h.trigger("woocommerce-product-addons-update")}).on("found_variation",function(a,o){var t=v(this),e=t.find("#product-addons-total");void 0!==o.display_price?e.data("price",o.display_price):v(o.price_html).find(".amount").last().length&&(o=(o=(o=(o=(o=v(o.price_html).find(".amount").last().text()).replace(woocommerce_addons_params.currency_format_symbol,"")).replace(woocommerce_addons_params.currency_format_thousand_sep,"")).replace(woocommerce_addons_params.currency_format_decimal_sep,".")).replace(/[^0-9\.]/g,""),o=parseFloat(o),e.data("price",o)),t.trigger("woocommerce-product-addons-update")}).on("woocommerce-product-addons-update",function(){var a=f.checkValidity(),_=0,m=0,t=h.find("#product-addons-total"),o=y&&0<y.length,e=h.find(".wcsatt-options-product"),c=0<e.length;product_id=o?y.val():t.data("product-id"),product_price=t.data("price"),product_type=t.data("type"),qty=parseFloat(h.find("input.qty").val()),addons=[];o=parseInt(product_id);if(g=!(!a||!o)||w,""===product_price&&"undefined"!=typeof custom_gift_card_amount&&custom_gift_card_amount.length&&0<custom_gift_card_amount.val()&&(product_price=custom_gift_card_amount.val()),woocommerce_addons_params.is_bookings&&v(".wc-bookings-booking-cost").length&&(product_price=parseFloat(v(".wc-bookings-booking-cost").attr("data-raw-price"))),h.find(".wc-pao-addon-field").each(function(){var o,a,t=v(this),e=t.parents(".wc-pao-addon"),c=e.find(".wc-pao-addon-name").length?e.find(".wc-pao-addon-name").data("addon-name"):"",n="",d=0,i=0,r=t.data("price-type"),s=!1,p={},l=!!e.find(".wc-pao-addon-name").length&&e.find(".wc-pao-addon-name").data("has-per-person-pricing"),u=!!e.find(".wc-pao-addon-name").length&&e.find(".wc-pao-addon-name").data("has-per-block-pricing");if(t.is(".wc-pao-addon-custom-price")){if(!t.val())return;s=!0,d=t.val(),i=t.val(),r="quantity_based"}else if(t.is(".wc-pao-addon-input-multiplier")){if(isNaN(t.val())||""===t.val()?(t.val(""),t.closest("p").find(".wc-pao-addon-alert").show()):(""!==t.val()&&t.val(Math.ceil(t.val())),t.closest("p").find(".wc-pao-addon-alert").hide()),!t.val())return;d=t.data("price")*t.val(),i=t.data("raw-price")*t.val()}else if(t.is(".wc-pao-addon-checkbox, .wc-pao-addon-radio")){if(!t.is(":checked"))return;n=t.data("label"),d=t.data("price"),i=t.data("raw-price")}else if(t.is(".wc-pao-addon-image-swatch-select, .wc-pao-addon-select")){if(!t.find("option:selected")||""===t.find("option:selected").val())return;r=t.find("option:selected").data("price-type"),t.val()&&(n=t.find("option:selected").data("label"),d=t.find("option:selected").data("price"),i=t.find("option:selected").data("raw-price"))}else{if(!t.val())return;d=t.data("price"),i=t.data("raw-price")}switch(d=d||0,i=i||0,"booking"!==product_type&&"accommodation-booking"!==product_type||!woocommerce_addons_params.is_bookings||(void(a=qty=0)!==v("#wc_bookings_field_duration")&&0<v("#wc_bookings_field_duration").val()&&(a=v("#wc_bookings_field_duration").val()),void 0!==v("#wc-bookings-form-end-time")&&0<v("#wc-bookings-form-end-time").val()&&(a=v("#wc-bookings-form-end-time").val()),e=v("#wc_bookings_field_persons"),o=0,1===e.length?o=parseInt(o,10)+parseInt(e.val(),10):v(".wc-bookings-booking-form").find("input").each(function(){var a=this.id.match(/wc_bookings_field_persons_(\d+)/);null!=a&&v("#"+a[0]).length&&(o=parseInt(o,10)+parseInt(v("#"+a[0]).val(),10))}),0===qty&&v(".wc-bookings-booking-cost").length&&(qty=1),l&&o&&(qty*=o),u&&a&&(qty*=a)),r){case"flat_fee":p.cost=parseFloat(d),p.cost_raw=parseFloat(i);break;case"quantity_based":p.cost_pu=parseFloat(d),p.cost_raw_pu=parseFloat(i),p.cost=p.cost_pu*qty,p.cost_raw=p.cost_raw_pu*qty;break;case"percentage_based":p.cost_pct=parseFloat(d)/100,p.cost_raw_pct=parseFloat(i)/100,p.cost=parseFloat(product_price)*p.cost_pct*qty,p.cost_raw=parseFloat(product_price)*p.cost_raw_pct*qty}_+=p.cost||0,m+=p.cost_raw||0,void 0!==n&&("number"==typeof n||n.length?p.name=c+(n?" - "+n:""):(a=t.val(),(n=parseInt(woocommerce_addons_params.trim_user_input_characters,10))<(a=t.is(".wc-pao-addon-file-upload")?a.replace(/^.*[\\\/]/,""):a).length&&(a=a.slice(0,n)+"..."),p.name=c+" - "+b.escapeHtml(a)),p.is_custom_price=s,p.price_type=r,addons.push(p))}),t.data("price_data",addons),qty){var n,d,o=b.formatMoney(_);if("undefined"!=typeof product_price&&product_id&&(s=v(".wc-bookings-booking-form").length?isNaN(product_price)?0:parseFloat(product_price):parseFloat(product_price*qty),n=b.formatMoney(s+_)),c?(c=h.data("satt_script"))&&c.schemes_model.get_active_scheme_key()&&((e=e.find("input:checked")).val()&&(d=e.parent().find(".subscription-details"))):h.parent().find(".subscription-details").length&&(h.hasClass("bundle_data")||(d=h.parent().find(".subscription-details"),y&&0<y.length&&(d=h.parent().find(".woocommerce-variation .subscription-details")))),d&&0<d.length&&(r=" "+d.clone().wrap("<p>").parent().html()),"grouped"===product_type?r&&!isGroupedMixedProductType()&&isGroupedSubsSelected()&&(n&&(n+=r)):r&&n&&(n+=r),n&&"1"==t.data("show-sub-total")){var i,r=h.find(".wc-pao-addon-container").data("product-name"),s=b.formatMoney(s);i=v(".wc-bookings-booking-form").length?'<div class="product-addon-totals"><ul><li><div class="wc-pao-col1"><strong>'+r+'</strong></div><div class="wc-pao-col2"><strong><span class="amount">'+s+"</span></strong></div></li>":'<div class="product-addon-totals"><ul><li><div class="wc-pao-col1"><strong><span>'+(x()?woocommerce_addons_params.quantity_symbol+qty:qty+woocommerce_addons_params.quantity_symbol)+"</span> "+r+'</strong></div><div class="wc-pao-col2"><strong><span class="amount">'+s+"</span></strong></div></li>";var p=!1;addons.length&&(v.each(addons,function(a,o){var t;"quantity_based"===o.price_type&&(t=0===(t=b.getCostByTax(o.cost_raw,o.cost))?"-":b.formatMoney(t),i=i+'<li class="wc-pao-row-quantity-based"><div class="wc-pao-col1">'+o.name+'</div><div class="wc-pao-col2"><span class="amount">'+t+"</span></div></li>"),woocommerce_addons_params.tax_enabled&&o.is_custom_price&&(p=!0)}),v.each(addons,function(a,o){var t;"quantity_based"!==o.price_type&&(t=0===(t="percentage_based"!==o.price_type?b.getCostByTax(o.cost_raw,o.cost):o.cost_raw)?"-":'<span class="amount">'+b.formatMoney(t)+"</span>",i=i+'<li><div class="wc-pao-col1"><strong>'+o.name+'</strong></div><div class="wc-pao-col2">'+t+"</div></li>")}));var l="",u=void 0===t.data("i18n_sub_total")?woocommerce_addons_params.i18n_sub_total:t.data("i18n_sub_total");return p||woocommerce_addons_params.price_display_suffix&&woocommerce_addons_params.tax_enabled?p||!1!=-1<woocommerce_addons_params.price_display_suffix.indexOf("{price_including_tax}")||!1!=-1<woocommerce_addons_params.price_display_suffix.indexOf("{price_excluding_tax}")?void v.ajax({type:"POST",url:woocommerce_addons_params.ajax_url,data:{action:"wc_product_addons_calculate_tax",product_id:product_id,add_on_total:_,add_on_total_raw:m,qty:qty},success:function(a){var o;i="SUCCESS"==a.result?(l='<small class="woocommerce-price-suffix">'+woocommerce_addons_params.price_display_suffix+"</small>",o=b.formatMoney(a.price_including_tax),a=b.formatMoney(a.price_excluding_tax),l=(l=l.replace("{price_including_tax}",'<span class="amount">'+o+"</span>")).replace("{price_excluding_tax}",'<span class="amount">'+a+"</span>"),a=woocommerce_addons_params.display_include_tax?o:a,i+'<li class="wc-pao-subtotal-line"><p class="price">'+u+' <span class="amount">'+a+"</span> "+l+" </p></li></ul></div>"):i+'<li class="wc-pao-subtotal-line"><p class="price">'+u+' <span class="amount">'+n+"</span></p></li></ul></div>",g?t.html(i):t.html(""),h.trigger("updated_addons")},error:function(){i=i+'<li class="wc-pao-subtotal-line"><p class="price">'+u+' <span class="amount">'+n+"</span></p></li></ul></div>",g?t.html(i):t.html(""),h.trigger("updated_addons")}}):(i=i+'<li class="wc-pao-subtotal-line"><strong>'+u+' <span class="amount">'+n+"</span> "+woocommerce_addons_params.price_display_suffix+"</strong></li></ul></div>",g?t.html(i):t.html(""),void h.trigger("updated_addons")):(i=i+'<li class="wc-pao-subtotal-line"><p class="price">'+u+' <span class="amount">'+n+"</span></p></li></ul></div>",g?t.html(i):t.html(""),void h.trigger("updated_addons"))}t.empty(),h.trigger("updated_addons")}else t.empty(),h.trigger("updated_addons")}).on("click touchend",".wc-pao-addon-image-swatch",function(a){a.preventDefault();var o=v(this).data("value"),t=v(this).parents(".wc-pao-addon-wrap"),a=v.parseHTML(v(this).data("price"));t.prevAll("label").find(".wc-pao-addon-image-swatch-price").remove(),t.find(".wc-pao-addon-image-swatch").removeClass("selected"),v(this).addClass("selected"),t.find(".wc-pao-addon-image-swatch-select").val(o),t.prevAll("label").append(v(a)),h.trigger("woocommerce-product-addons-update")}),h.find(" .wc-pao-addon-custom-text, .wc-pao-addon-custom-textarea").each(function(){0<v(this).attr("maxlength")&&v(this).after('<small class="wc-pao-addon-chars-remaining">'+woocommerce_addons_params.i18n_remaining+"</small>")}),v("#credit_called").on("keyup",function(){h.trigger("woocommerce-product-addons-update")}),h.trigger("woocommerce-product-addons-update");a=h.get(0).querySelector('button[type="submit"]');a&&a.addEventListener("click",function(){var a=h.get(0).querySelector("*:invalid");a&&(a.focus(),a.scrollIntoView({block:"center"}))}),v(".wc-pao-addon-image-swatch").tipTip({delay:200})}},x=function(){return"rtl"===document.documentElement.dir};v("body").on("quick-view-displayed",function(){v(this).find(".cart:not(.cart_group)").each(function(){b.init(v(this))})}),v("body .component").on("wc-composite-component-loaded",function(){v(this).find(".cart").each(function(){b.init(v(this))})}),v("body").find(".cart:not(.cart_group)").each(function(){b.init(v(this))}),v("body").find(".wc-pao-addon-checkbox-group-required").each(function(){var a=this;v(this).find(".wc-pao-addon-checkbox").change(function(){0<v(a).find("input:checked").length?(v(a).removeClass("wc-pao-addon-checkbox-required-error"),v(a).find("input").each(function(){v(this).attr("required",!1)})):(v(a).addClass("wc-pao-addon-checkbox-required-error"),v(a).find("input").each(function(){v(this).attr("required",!0)}))})})});
